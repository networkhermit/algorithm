#include <muse/algorithms/number_theory/LeastCommonMultiple.h>
#include <muse/util/TestRunner.h>

bool testLeastCommonMultiple(void) {
  long sample[][3] = {
      {1, 1, 1},
      {-1, -1, 1},
      {-85, -8, 680},
      {33, -2, 66},
      {8, 32, 32},
      {8, 89, 712},
      {16, 78, 624},
      {-66, -2, 66},
      {-50, -62, 1550},
      {12, -25, 300},
      {-74, -25, 1850},
      {4, 24, 24},
      {90, 29, 2610},
      {-62, -85, 5270},
      {-9, -50, 450},
      {90, -59, 5310},
      {-8732, -1743, 15'219'876},
      {-8329, 8430, 70'213'470},
      {3300, -1326, 729300},
      {-5969, -523, 3'121'787},
      {-7044, -8745, 20'533'260},
      {-4683, 2491, 11'665'353},
      {9729, 4329, 4'679'649},
      {-871, 3189, 2'777'619},
      {-1158, -3122, 1'807'638},
      {9912, -9910, 49'113'960},
      {4924, 5842, 14'383'004},
      {3980, -6455, 5'138'180},
      {5420, -1507, 8'167'940},
      {-1090, 7747, 8'444'230},
      {-8008, 7290, 29'189'160},
      {-2260, -6189, 13'987'140},
      {-962, 9376, 4'509'856},
      {-351, 8756, 3'073'356},
      {-171, 8401, 1'436'571},
      {-3110, -7937, 24'684'070},
      {6362, 1928, 6'132'968},
      {-8230, 964, 3'966'860},
      {-5791, 6186, 35'823'126},
      {-4204, 9556, 10'043'356},
      {-3338, 6848, 11'429'312},
      {-760, 8766, 3'331'080},
      {-1958, 4928, 438592},
      {-3830, -107, 409810},
      {-7809, 9720, 25'301'160},
      {7665, 209, 1'601'985},
      {-6060, 4881, 9'859'620},
      {2346, -9979, 1'377'102},
      {7125, -5604, 13'309'500},
      {9862, 3015, 29'733'930},
      {-1148, 8092, 331772},
      {8627, 3929, 33'895'483},
      {-5320, 8927, 47'491'640},
      {-2301, -8803, 20'255'703},
      {6395, -8793, 56'231'235},
      {6278, -2847, 244842},
      {1623, 3406, 5'527'938},
      {-3974, 1259, 5'003'266},
      {-4014, -3066, 2'051'154},
      {7546, -3833, 28'923'818},
      {4058, -4338, 8'801'802},
      {5066, 7450, 126650},
      {-9458, -5234, 24'751'586},
      {4142, 5319, 22'031'298},
      {4119, -9963, 13'679'199},
      {813, 1892, 1'538'196},
      {4375, 9055, 7'923'125},
      {388, -4329, 1'679'652},
      {3927, 5720, 2'042'040},
      {5099, -5563, 28'365'737},
      {-4174, 4772, 9'959'164},
      {-8829, 6842, 60'408'018},
      {9834, 8283, 2'468'334},
      {-6028, -2949, 17'776'572},
      {2627, -2463, 6'470'301},
      {9431, -5198, 49'022'338},
      {4553, 6198, 28'219'494},
      {1368, -8772, 1'000'008},
      {-43336, -36185, 1'568'113'160},
      {33606, -19136, 321'542'208},
      {-23381, 31250, 730'656'250},
      {-22377, -22397, 501'177'669},
      {-22766, -10042, 114'308'086},
      {-37379, -13431, 502'037'349},
      {-23248, -18591, 432'203'568},
      {-34910, 37688, 657'844'040},
      {-29156, 26259, 765'607'404},
      {33346, 19239, 641'543'694},
      {-31634, 13587, 429'811'158},
      {22300, 14536, 81'038'200},
      {-25315, 26148, 661'936'620},
      {-21579, -43116, 310'133'388},
      {-25141, 37870, 952'089'670},
      {23741, 10471, 248'592'011},
      {26852, -41498, 557'152'148},
      {26627, -21629, 575'915'383},
      {-13538, -16865, 228'318'370},
      {25331, 31258, 791'796'398},
      {33885, 13483, 456'871'455},
      {-43671, -16383, 238'487'331},
      {-29483, 26616, 784'719'528},
      {15792, -11008, 10'864'896},
      {23749, 40466, 961'027'034},
      {-37432, -42397, 1'587'004'504},
      {-46035, -24237, 123'972'255},
      {-38120, 10830, 41'283'960},
      {-11808, -10396, 30'688'992},
      {-15667, -15508, 242'963'836},
      {-15336, -35057, 537'634'152},
      {31050, -13757, 427'154'850},
      {42602, -20701, 881'904'002},
      {-20505, 18475, 75'765'975},
      {35445, 12527, 444'019'515},
      {-20600, -23702, 244'130'600},
      {21432, 15715, 336'803'880},
      {-24635, 45838, 86'863'010},
      {20616, 41256, 35'438'904},
      {-40536, 29009, 1'175'908'824},
      {-29015, -40786, 1'183'405'790},
      {17092, -30650, 261'934'900},
      {-44577, 31261, 1'393'521'597},
      {-35517, 13916, 494'254'572},
      {-22680, 39616, 112'311'360},
      {33207, -33473, 1'111'537'911},
      {30250, -28845, 174'512'250},
      {45203, -23693, 1'070'994'679},
      {46340, 46341, 2'147'441'940},
      {-46340, -46341, 2'147'441'940},
  };

  for (size_t i = 0, size = *(&sample + 1) - sample; i < size; i++) {
    if (LeastCommonMultiple_reduceToBinaryGCD(sample[i][0], sample[i][1]) !=
        sample[i][2]) {
      return false;
    }
  }

  for (size_t i = 0, size = *(&sample + 1) - sample; i < size; i++) {
    if (LeastCommonMultiple_reduceToEuclidean(sample[i][0], sample[i][1]) !=
        sample[i][2]) {
      return false;
    }
  }

  return true;
}

int main(void) { TestRunner_pick(&testLeastCommonMultiple); }
