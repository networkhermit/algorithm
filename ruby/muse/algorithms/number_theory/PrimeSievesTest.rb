require "muse/algorithms/number_theory/Primality"
require "muse/algorithms/number_theory/PrimeSieves"
require "muse/util/TestRunner"

def testPrimeSieves
  sample = [
    [0, 0],
    [1, 0],
    [180, 41],
    [26, 9],
    [350, 70],
    [521, 98],
    [307, 63],
    [163, 38],
    [181, 42],
    [372, 73],
    [421, 82],
    [241, 53],
    [229, 50],
    [169, 39],
    [442, 85],
    [445, 86],
    [338, 68],
    [306, 62],
    [56, 16],
    [270, 57],
    [499, 95],
    [173, 40],
    [18, 7],
    [43, 14],
    [218, 47],
    [122, 30],
    [265, 56],
    [467, 91],
    [381, 75],
    [11, 5],
    [409, 80],
    [233, 51],
    [1119, 187],
    [6976, 896],
    [4355, 594],
    [7757, 984],
    [3467, 486],
    [5824, 764],
    [7724, 980],
    [1470, 232],
    [7894, 997],
    [6788, 873],
    [7873, 994],
    [6874, 885],
    [3554, 497],
    [4137, 569],
    [7878, 995],
    [3390, 477],
    [2141, 323],
    [4642, 626],
    [2718, 396],
    [7126, 912],
    [1022, 172],
    [5651, 743],
    [4822, 649],
    [2022, 306],
    [6449, 837],
    [2153, 325],
    [1323, 216],
    [6960, 893],
    [2837, 412],
    [4212, 576],
    [2179, 327],
    [1033, 174],
    [33_023, 3540],
    [65_798, 6572],
    [39_761, 4179],
    [12_379, 1478],
    [25_339, 2794],
    [50_093, 5143],
    [98_641, 9471],
    [84_959, 8272],
    [90_697, 8778],
    [20_898, 2350],
    [63_079, 6326],
    [18_369, 2104],
    [23_459, 2611],
    [55_337, 5620],
    [55_057, 5596],
    [94_463, 9111],
    [22_769, 2544],
    [22_501, 2516],
    [68_369, 6799],
    [65_315, 6524],
    [72_893, 7206],
    [44_969, 4672],
    [69_511, 6902],
    [24_371, 2705],
    [32_579, 3497],
    [26_017, 2862],
    [84_309, 8217],
    [100_043, 9595],
    [86_861, 8440],
    [79_355, 7776],
    [14_445, 1693],
    [95_418, 9197],
    [1_209_025, 93_544],
    [526_733, 43_583],
    [832_339, 66_339],
    [350_593, 30_017],
    [616_581, 50_358],
    [787_123, 62_995],
    [474_923, 39_612],
    [320_448, 27_647],
    [617_049, 50_394],
    [232_333, 20_622],
    [651_727, 52_944],
    [524_873, 43_427],
    [1_008_852, 79_161],
    [187_573, 16_970],
    [432_235, 36_339],
    [714_479, 57_629],
    [669_287, 54_254],
    [633_133, 51_574],
    [964_012, 75_920],
    [663_127, 53_800],
    [1_257_461, 96_995],
    [172_171, 15_681],
    [1_112_392, 86_634],
    [912_533, 72_211],
    [409_529, 34_574],
    [691_575, 55_914],
    [742_768, 59_730],
    [479_430, 39_964],
    [108_289, 10_303],
    [1_228_187, 94_920],
    [709_431, 57_257],
    [1_294_061, 99_610]
  ]

  arr = nil

  sample.each_index do |i|
    arr = PrimeSieves.sieveOfEratosthenes(sample[i][0])

    return false if arr.length != sample[i][1]

    arr.each do |v|
      return false unless Primality.isPrime(v)
    end
  end

  true
end

TestRunner.pick(testPrimeSieves) if __FILE__ == $PROGRAM_NAME
